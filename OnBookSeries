/*
OBJECTIVE: BOOK SERIES
SHOWCASE: CASE STATEMENTS, NUMERIC FUNCTIONS, STRING FUNCTIONS.
*/


---------------------------------------------------------------------------
----- BRIDGERTON SERIES
---------------------------------------------------------------------------


CREATE TABLE   `booklists.bridgerton_series`
         (Book_Author STRING,
          Book_Serie STRING,
          Book_Order INTEGER,
          Book_Title STRING,
          Page_Count INTEGER,
          Protagonist STRING,
          Protagonist_Gender STRING,
          Protagonist_Age INTEGER,
          Deuteragonist STRING,
          Deuteragonist_Gender STRING,
          Deuteragonist_Age INTEGER)


INSERT INTO   `booklists.bridgerton_series` 
         (Book_Author, Book_Serie, Book_Title, Page_Count)
SELECT   Book_Author, Book_Series, Book_Title, Page_Counts
FROM     `booklists.books_2021`
WHERE    Book_Series = "Bridgerton"

INSERT INTO   `booklists.bridgerton_series` 
         (Book_Author, Book_Serie, Book_Title, Page_Count)
SELECT   Book_Author, Book_Series, Book_Title, Page_Counts
FROM     `booklists.books_2022`
WHERE    Book_Series = "Bridgerton"


----------


UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 1,
         Protagonist = "Daphne",
         Protagonist_Gender = "F",
         Protagonist_Age = 21,
         Deuteragonist = "Simon Basset",
         Deuteragonist_Gender = "M",
         Deuteragonist_Age = 29
WHERE    Book_Title = "The Duke and I"

UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 2,
         Protagonist = "Anthony",
         Protagonist_Gender = "M",
         Protagonist_Age = 29,
         Deuteragonist = "Kate Sheffield",
         Deuteragonist_Gender = "F",
         Deuteragonist_Age = 21
WHERE    Book_Title = "The Viscount Who Loved Me"

UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 3,
         Protagonist = "Benedict",
         Protagonist_Gender = "M",
         Protagonist_Age = 30,
         Deuteragonist = "Sophie Beckett",
         Deuteragonist_Gender = "F",
         Deuteragonist_Age = 22
WHERE    Book_Title = "An Offer From A Gentleman"


UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 4,
         Protagonist = "Colin",
         Protagonist_Gender = "M",
         Protagonist_Age = 33,
         Deuteragonist = "Penelope Featherington",
         Deuteragonist_Gender = "F",
         Deuteragonist_Age = 28
WHERE    Book_Title = "Romancing Mr. Bridgerton"

UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 5,
         Protagonist = "Eloise",
         Protagonist_Gender = "F",
         Protagonist_Age = 28,
         Deuteragonist = "Phillip Crane",
         Deuteragonist_Gender = "M",
         Deuteragonist_Age = 30
WHERE    Book_Title = "To Sir Phillip, With Love"


UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 6,
         Protagonist = "Francesca",
         Protagonist_Gender = "F",
         Protagonist_Age = 26,
         Deuteragonist = "Michael Stirling",
         Deuteragonist_Gender = "M",
         Deuteragonist_Age = 33
WHERE    Book_Title = "When He Was Wicked"

UPDATE   `booklists.bridgerton_series` 
SET      Book_Order = 7,
         Protagonist = "Hyacinth",
         Protagonist_Gender = "F",
         Protagonist_Age = 22,
         Deuteragonist = "Gareth St. Clair",
         Deuteragonist_Gender = "M",
         Deuteragonist_Age = 28
WHERE    Book_Title = "It's In His Kiss"


----------


INSERT INTO    `booklists.bridgerton_series` 
         (Book_Author, Book_Serie, Book_Order, Book_Title, Page_Count,
          Protagonist, Protagonist_Gender, Protagonist_Age, 
          Deuteragonist, Deuteragonist_Gender, Deuteragonist_Age)
VALUES   ("Julia Quinn", "Bridgerton", 8, "On The Way To The Wedding", 496,
          "Gregory", "M", 26,
          "Lucy Abernathy", "F", 20)


----------


UPDATE   `booklists.bridgerton_series`
SET      Protagonist = CONCAT(Protagonist, " Bridgerton")
WHERE    Book_Serie = "Bridgerton"


----------


SELECT   Book_Title, Protagonist,
         CASE
         WHEN   Protagonist LIKE "Anthony%" THEN "Viscount Bridgerton"
         WHEN   Protagonist LIKE "Daphne%" THEN "Duchess of Hastings"
         WHEN   Protagonist LIKE "Eloise%" THEN "Lady Crane"
         WHEN   Protagonist LIKE "Francesca%" THEN "Countess of Kilmartin"
         WHEN   Protagonist LIKE "Hyacinth%" THEN "Baroness St. Clair"
         ELSE   NULL
         END    AS Protagonist_Title,
         Deuteragonist,
         CASE
         WHEN   Deuteragonist LIKE "Kate%" THEN "Viscountess Bridgerton"
         WHEN   Deuteragonist LIKE "Penelope%" THEN "Lady Whistledown"
         WHEN   Deuteragonist LIKE "Simon%" THEN "Duke of Hastings"
         WHEN   Deuteragonist LIKE "Phillip%" THEN "Sir Phillip Crane"
         WHEN   Deuteragonist LIKE "Michael%" THEN "Earl of Kilmartin"
         WHEN   Deuteragonist LIKE "Lucy%" THEN "Lady Lucinda"
         WHEN   Deuteragonist LIKE "Gareth%" THEN "Baron St. Clair"
         ELSE   NULL
         END    AS Deuteragonist_Title
FROM     `booklists.bridgerton_series`
ORDER BY Protagonist


----------


SELECT   Book_Title, Protagonist, Deuteragonist, ABS(Protagonist_Age - Deuteragonist_Age) AS Age_Gap
FROM     `booklists.bridgerton_series`
ORDER BY Protagonist


----------





---------------------------------------------------------------------------
----- ROBERT LANGDON SERIES
---------------------------------------------------------------------------


